// Minimal Chart.js stub to satisfy extension CSP during testing
// This implements a tiny subset of Chart's API used by the popup for basic rendering.
(function(global){
  function Chart(ctx, config){
    this.ctx = ctx;
    this.config = config;
    this._destroyed = false;
    // simple placeholder: draw a background and a label
    try{
      const canvas = (ctx && ctx.getContext) ? ctx : (typeof ctx === 'string' ? document.getElementById(ctx) : ctx);
      if (canvas && canvas.getContext) {
        const c = canvas.getContext('2d');
        c.clearRect(0,0,canvas.width,canvas.height);
        c.fillStyle = '#f3f6fb';
        c.fillRect(0,0,canvas.width,canvas.height);
        c.fillStyle = '#4facfe';
        c.font = '12px sans-serif';
        c.fillText((config && config.data && config.data.datasets && config.data.datasets[0] && config.data.datasets[0].label) || 'Chart', 10, 20);
      }
    }catch(e){console.warn('Chart stub draw failed', e)}
  }
  Chart.prototype.destroy = function(){ this._destroyed = true; };
  Chart.prototype.resize = function(){ /* no-op for stub */ };
  global.Chart = Chart;
})(this || window);
